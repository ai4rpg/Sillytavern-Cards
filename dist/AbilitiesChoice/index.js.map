{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.22_typescript@6.0.0-dev.20250807__webpack@5.102.1/node_modules/vue-loader/dist/exportHelper.js","src://tavern_helper_template/webpack/bootstrap","src://tavern_helper_template/external var \"Vue\"","webpack://tavern_helper_template/./src/AbilitiesChoice/app.vue?4ab9","src://tavern_helper_template/src/AbilitiesChoice/actions.ts","webpack://tavern_helper_template/src/AbilitiesChoice/app.vue?7ae1","src://tavern_helper_template/src/AbilitiesChoice/index.ts"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// runtime helper for setting properties on components\n// in a tree-shakable way\nexports.default = (sfc, props) => {\n    const target = sfc.__vccOpts || sfc;\n    for (const [key, val] of props) {\n        target[key] = val;\n    }\n    return target;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const __WEBPACK_NAMESPACE_OBJECT__ = Vue;","import { defineComponent as _defineComponent } from 'vue';\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = { class: \"skill-card-header\" };\nconst _hoisted_2 = { class: \"skill-title\" };\nconst _hoisted_3 = { class: \"skill-meta\" };\nconst _hoisted_4 = { class: \"skill-quality\" };\nconst _hoisted_5 = { class: \"skill-nature\" };\nconst _hoisted_6 = { class: \"skill-card-body\" };\nconst _hoisted_7 = { class: \"skill-card-header\" };\nconst _hoisted_8 = { class: \"skill-title\" };\nconst _hoisted_9 = { class: \"skill-meta\" };\nconst _hoisted_10 = { class: \"skill-quality\" };\nconst _hoisted_11 = { class: \"skill-nature\" };\nconst _hoisted_12 = { class: \"skill-card-body\" };\nconst _hoisted_13 = { class: \"skill-card-header\" };\nconst _hoisted_14 = { class: \"skill-title\" };\nconst _hoisted_15 = { class: \"skill-meta\" };\nconst _hoisted_16 = { class: \"skill-quality\" };\nconst _hoisted_17 = { class: \"skill-nature\" };\nconst _hoisted_18 = { class: \"skill-card-body\" };\nimport { onMounted, ref } from 'vue';\nimport { selectAbility } from './actions';\nexport default /*@__PURE__*/ _defineComponent({\n    __name: 'app',\n    setup(__props) {\n        const isSelecting = ref(false);\n        const bast = ref({\n            ability_name: 'Loading...',\n            ability_quality: '',\n            ability_description: '',\n            is_passive: false,\n        });\n        const hypnos = ref({\n            ability_name: 'Loading...',\n            ability_quality: '',\n            ability_description: '',\n            is_passive: false,\n        });\n        const nodens = ref({\n            ability_name: 'Loading...',\n            ability_quality: '',\n            ability_description: '',\n            is_passive: false,\n        });\n        const handleSelect = async (ability) => {\n            if (isSelecting.value)\n                return;\n            isSelecting.value = true;\n            await selectAbility(ability);\n        };\n        onMounted(async () => {\n            try {\n                await waitGlobalInitialized('Mvu');\n                const mvuData = Mvu.getMvuData({ type: 'message', message_id: 'latest' });\n                if (!mvuData || !mvuData.stat_data) {\n                    throw new Error('未在聊天变量中找到 stat_data。');\n                }\n                const generatedAbilities = mvuData?.stat_data?.latent_variables?.ability_update?.generated_abilities[0];\n                if (generatedAbilities && Array.isArray(generatedAbilities) && generatedAbilities.length === 3) {\n                    bast.value = generatedAbilities[0];\n                    hypnos.value = generatedAbilities[1];\n                    nodens.value = generatedAbilities[2];\n                }\n                else {\n                    throw new Error('未能够正确获取 AI 生成的候选能力');\n                }\n            }\n            catch (error) {\n                console.error('Failed to initialize AbilitiesChoice:', error);\n                bast.value.ability_name = 'Error';\n                bast.value.ability_description = String(error);\n                hypnos.value.ability_name = 'Error';\n                hypnos.value.ability_description = String(error);\n                nodens.value.ability_name = 'Error';\n                nodens.value.ability_description = String(error);\n            }\n        });\n        return (_ctx, _cache) => {\n            return (_openBlock(), _createElementBlock(_Fragment, null, [\n                _cache[3] || (_cache[3] = _createElementVNode(\"div\", { class: \"hud-header\" }, [\n                    _createElementVNode(\"h2\", { class: \"hud-block-title\" }, \"[ 新的特殊能力 ]\"),\n                    _createElementVNode(\"div\", { class: \"hud-phase\" }, \"选择一个祝福\")\n                ], -1 /* CACHED */)),\n                _createElementVNode(\"div\", {\n                    class: _normalizeClass([\"skill-upgrade-grid\", { selecting: isSelecting.value }])\n                }, [\n                    _createElementVNode(\"div\", {\n                        class: \"skill-card\",\n                        id: \"bast\",\n                        onClick: _cache[0] || (_cache[0] = ($event) => (handleSelect(bast.value)))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_1, [\n                            _createElementVNode(\"h3\", _hoisted_2, _toDisplayString(bast.value.ability_name), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_3, [\n                                _createElementVNode(\"span\", _hoisted_4, _toDisplayString(bast.value.ability_quality), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_5, _toDisplayString(bast.value.is_passive ? '被动' : '主动'), 1 /* TEXT */)\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_6, _toDisplayString(bast.value.ability_description), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", {\n                        class: \"skill-card\",\n                        id: \"hypnos\",\n                        onClick: _cache[1] || (_cache[1] = ($event) => (handleSelect(hypnos.value)))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_7, [\n                            _createElementVNode(\"h3\", _hoisted_8, _toDisplayString(hypnos.value.ability_name), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_9, [\n                                _createElementVNode(\"span\", _hoisted_10, _toDisplayString(hypnos.value.ability_quality), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_11, _toDisplayString(hypnos.value.is_passive ? '被动' : '主动'), 1 /* TEXT */)\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_12, _toDisplayString(hypnos.value.ability_description), 1 /* TEXT */)\n                    ]),\n                    _createElementVNode(\"div\", {\n                        class: \"skill-card\",\n                        id: \"nodens\",\n                        onClick: _cache[2] || (_cache[2] = ($event) => (handleSelect(nodens.value)))\n                    }, [\n                        _createElementVNode(\"div\", _hoisted_13, [\n                            _createElementVNode(\"h3\", _hoisted_14, _toDisplayString(nodens.value.ability_name), 1 /* TEXT */),\n                            _createElementVNode(\"div\", _hoisted_15, [\n                                _createElementVNode(\"span\", _hoisted_16, _toDisplayString(nodens.value.ability_quality), 1 /* TEXT */),\n                                _createElementVNode(\"span\", _hoisted_17, _toDisplayString(nodens.value.is_passive ? '被动' : '主动'), 1 /* TEXT */)\n                            ])\n                        ]),\n                        _createElementVNode(\"div\", _hoisted_18, _toDisplayString(nodens.value.ability_description), 1 /* TEXT */)\n                    ])\n                ], 2 /* CLASS */)\n            ], 64 /* STABLE_FRAGMENT */));\n        };\n    }\n});\n","export async function selectAbility(ability: any) {\n  try {\n    await waitGlobalInitialized('Mvu');\n    const mvuData = Mvu.getMvuData({ type: 'message', message_id: 'latest' });\n    if (!mvuData || !mvuData.stat_data) {\n      throw new Error('未在聊天变量中找到 stat_data。');\n    }\n\n    if (ability.is_used !== false) {\n      ability.is_used = false;\n    }\n\n    const command = `_.assign('user.special_abilities[0]', ${ability}); // choose a special abilities`;\n    const newMvuData = await Mvu.parseMessage(command, mvuData);\n\n    if (newMvuData) {\n      await Mvu.replaceMvuData(newMvuData, { type: 'message', message_id: 'latest' });\n    }\n    toastr.success(`已选择能力: ${ability.ability_name}`);\n  } catch (error) {\n    console.error('Failed to select ability:', error);\n    toastr.error(`选择能力失败: ${String(error)}`);\n  }\n}\n","/* unplugin-vue-components disabled */import script from \"./app.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./app.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./app.vue?vue&type=style&index=0&id=df14af94&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.22_typescript@6.0.0-dev.20250807__webpack@5.102.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-df14af94\"]])\n\nexport default __exports__","import { createApp } from 'vue';\nimport app from './app.vue';\n\n$(() => {\n  createApp(app).mount('#app');\n});\n"],"names":["exports","sfc","props","target","__vccOpts","key","val","__webpack_module_cache__","Vue","_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","__name","setup","__props","isSelecting","ref","bast","ability_name","ability_quality","ability_description","is_passive","hypnos","nodens","handleSelect","async","ability","value","waitGlobalInitialized","mvuData","Mvu","getMvuData","type","message_id","stat_data","Error","is_used","command","newMvuData","parseMessage","replaceMvuData","toastr","success","error","console","String","selectAbility","onMounted","generatedAbilities","latent_variables","ability_update","generated_abilities","Array","isArray","length","_ctx","_cache","selecting","id","onClick","$event","__webpack_require__","moduleId","cachedModule","undefined","module","__webpack_modules__","$","createApp","app","mount"],"sourceRoot":""}