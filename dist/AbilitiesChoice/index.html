<head><script type="module">const e=Vue;const a={class:'skill-card-header'},t={class:'skill-title'},i={class:'skill-meta'},l={class:'skill-card-body'},s={class:'skill-card-header'},r={class:'skill-title'},n={class:'skill-meta'},o={class:'skill-card-body'},c={class:'skill-card-header'},d={class:'skill-title'},y={class:'skill-meta'},v={class:'skill-card-body'},u=(0,e.defineComponent)({__name:'app',setup(u){const p=(0,e.ref)(!1),m=(0,e.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),b=(0,e.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),g=(0,e.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),E=async e=>{p.value||(p.value=!0,await async function(e){try{await waitGlobalInitialized('Mvu');const a=Mvu.getMvuData({type:'message',message_id:'latest'});if(!a||!a.stat_data)throw new Error('未在聊天变量中找到 stat_data。');!1!==e.is_used&&(e.is_used=!1);const t=`_.assign('user.special_abilities[0]', ${e}); // choose a special abilities`,i=await Mvu.parseMessage(t,a);i&&await Mvu.replaceMvuData(i,{type:'message',message_id:'latest'}),toastr.success(`已选择能力: ${e.ability_name}`)}catch(e){console.error('Failed to select ability:',e),toastr.error(`选择能力失败: ${String(e)}`)}}(e))};function k(e){switch(e){case'普通':return'var(--text-dim)';case'稀有':return'var(--aq-green)';case'史诗':return'var(--aq-orange)';case'传说':return'var(--aq-gold)';default:return'var(--text-light)'}}return(0,e.onMounted)(async()=>{try{await waitGlobalInitialized('Mvu');const e=Mvu.getMvuData({type:'message',message_id:'latest'});if(!e||!e.stat_data)throw new Error('未在聊天变量中找到 stat_data。');const a=e?.stat_data?.latent_variables?.ability_update?.generated_abilities[0];if(!a||!Array.isArray(a)||3!==a.length)throw new Error('未能够正确获取 AI 生成的候选能力');m.value=a[0],b.value=a[1],g.value=a[2]}catch(e){console.error('Failed to initialize AbilitiesChoice:',e),m.value.ability_name='Error',m.value.ability_description=String(e),b.value.ability_name='Error',b.value.ability_description=String(e),g.value.ability_name='Error',g.value.ability_description=String(e)}}),(u,V)=>((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,null,[V[3]||(V[3]=(0,e.createElementVNode)('div',{class:'hud-header'},[(0,e.createElementVNode)('h2',{class:'hud-block-title'},'[ 新的特殊能力 ]'),(0,e.createElementVNode)('div',{class:'hud-phase'},'选择一个祝福')],-1)),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['skill-upgrade-grid',{selecting:p.value}])},[(0,e.createElementVNode)('div',{class:'skill-card',id:'bast',onClick:V[0]||(V[0]=e=>E(m.value))},[(0,e.createElementVNode)('div',a,[(0,e.createElementVNode)('h3',t,(0,e.toDisplayString)(m.value.ability_name),1),(0,e.createElementVNode)('div',i,[(0,e.createElementVNode)('span',{class:'skill-quality',style:(0,e.normalizeStyle)({color:k(m.value.ability_quality)})},(0,e.toDisplayString)(m.value.ability_quality),5),(0,e.createElementVNode)('span',{class:'skill-nature',style:(0,e.normalizeStyle)({color:m.value.is_passive?'var(--detective-cyan)':'var(--erotic-pink)'})},(0,e.toDisplayString)(m.value.is_passive?'被动':'主动'),5)])]),(0,e.createElementVNode)('div',l,(0,e.toDisplayString)(m.value.ability_description),1)]),(0,e.createElementVNode)('div',{class:'skill-card',id:'hypnos',onClick:V[1]||(V[1]=e=>E(b.value))},[(0,e.createElementVNode)('div',s,[(0,e.createElementVNode)('h3',r,(0,e.toDisplayString)(b.value.ability_name),1),(0,e.createElementVNode)('div',n,[(0,e.createElementVNode)('span',{class:'skill-quality',style:(0,e.normalizeStyle)({color:k(b.value.ability_quality)})},(0,e.toDisplayString)(b.value.ability_quality),5),(0,e.createElementVNode)('span',{class:'skill-nature',style:(0,e.normalizeStyle)({color:b.value.is_passive?'var(--detective-cyan)':'var(--erotic-pink)'})},(0,e.toDisplayString)(b.value.is_passive?'被动':'主动'),5)])]),(0,e.createElementVNode)('div',o,(0,e.toDisplayString)(b.value.ability_description),1)]),(0,e.createElementVNode)('div',{class:'skill-card',id:'nodens',onClick:V[2]||(V[2]=e=>E(g.value))},[(0,e.createElementVNode)('div',c,[(0,e.createElementVNode)('h3',d,(0,e.toDisplayString)(g.value.ability_name),1),(0,e.createElementVNode)('div',y,[(0,e.createElementVNode)('span',{class:'skill-quality',style:(0,e.normalizeStyle)({color:k(g.value.ability_quality)})},(0,e.toDisplayString)(g.value.ability_quality),5),(0,e.createElementVNode)('span',{class:'skill-nature',style:(0,e.normalizeStyle)({color:g.value.is_passive?'var(--detective-cyan)':'var(--erotic-pink)'})},(0,e.toDisplayString)(g.value.is_passive?'被动':'主动'),5)])]),(0,e.createElementVNode)('div',v,(0,e.toDisplayString)(g.value.ability_description),1)])],2)],64))}});$(()=>{(0,e.createApp)(u).mount('#app')});
//# sourceMappingURL=index.js.map</script><style>.hud-header{display:flex;justify-content:space-between;align-items:center}.hud-block-title{color:var(--detective-cyan);font-family:var(--font-hud);margin:0}.skill-upgrade-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-top:15px}.skill-card{background:rgba(0,0,0,.3);border:1px solid var(--border-color);border-radius:6px;padding:15px;display:flex;flex-direction:column;transition:all .3s ease;position:relative;overflow:hidden;cursor:pointer}.skill-upgrade-grid:not(.selecting) .skill-card:hover{transform:translateY(-5px);border-color:var(--detective-cyan);box-shadow:0 0 15px rgba(0,255,255,.3)}.skill-upgrade-grid.selecting .skill-card{pointer-events:none;opacity:.6}.skill-card-header{font-family:var(--font-hud);text-align:center;margin-bottom:15px}.skill-title{font-size:1.25rem;color:var(--detective-cyan);text-shadow:var(--cyan-glow);margin:0;padding-bottom:5px;border-bottom:1px dashed rgba(0,255,255,.4);text-transform:uppercase}.skill-meta{display:flex;justify-content:space-between;font-size:.8rem;margin-top:8px;color:var(--text-dim);text-transform:uppercase}.skill-quality,.skill-nature{padding:2px 6px;border-radius:3px;font-weight:700}.skill-card-body{font-family:var(--font-main);color:var(--text-light);font-size:.9rem;line-height:1.6;flex-grow:1;white-space:pre-wrap}@media (max-width:900px){.skill-upgrade-grid{grid-template-columns:1fr;gap:12px}.hud-header{flex-direction:column;align-items:flex-start;gap:8px}.skill-card{padding:12px}.skill-title{font-size:1.1rem}}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>