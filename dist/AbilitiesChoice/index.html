<head><script type="module">const e=Vue,a=_;const t={class:'skill-card-header'},i={class:'skill-title'},l={class:'skill-meta'},s={class:'skill-card-body'},r={class:'skill-card-header'},n={class:'skill-title'},o={class:'skill-meta'},c={class:'skill-card-body'},d={class:'skill-card-header'},y={class:'skill-title'},u={class:'skill-meta'},v={class:'skill-card-body'},p=(0,e.defineComponent)({__name:'app',setup(p){const m=(0,e.ref)(!1),b=(0,e.ref)([]),g=(0,e.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),E=(0,e.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),k=(0,e.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),N=async e=>{m.value||(m.value=!0,await async function(e){try{await waitGlobalInitialized('Mvu');const t=Mvu.getMvuData({type:'message',message_id:'latest'});if(!t||!t.stat_data)throw new Error('未在聊天变量中找到 stat_data。');(0,a.isEqual)(e.is_used,[!1,''])||(e.is_used=[!1,'']);const i=`_.assign('user.special_abilities[0]', ${JSON.stringify(e)}); // choose a special abilities`,l=await Mvu.parseMessage(i,t);l&&(t.delta_data&&(l.delta_data=(0,a.merge)({},t.delta_data,l.delta_data)),await Mvu.replaceMvuData(l,{type:'message',message_id:'latest'})),toastr.success(`已选择能力: ${e.ability_name}`)}catch(e){console.error('Failed to select ability:',e),toastr.error(`选择能力失败: ${String(e)}`)}}(b.value[e]))};function V(e){switch(e){case'普通':return'var(--text-dim)';case'稀有':return'var(--aq-green)';case'史诗':return'var(--aq-orange)';case'传说':return'var(--aq-gold)';default:return'var(--text-light)'}}function h(e){const a={};for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(Array.isArray(e[t])&&e[t].length>0?a[t]=e[t][0]:a[t]=e[t]);return a}return(0,e.onMounted)(async()=>{try{await waitGlobalInitialized('Mvu');const e=Mvu.getMvuData({type:'message',message_id:'latest'});if(!e||!e.stat_data)throw new Error('未在聊天变量中找到 stat_data。');const a=e?.stat_data?.latent_variables?.ability_update?.generated_abilities[0];if(!a||!Array.isArray(a)||3!==a.length)throw new Error('未能够正确获取 AI 生成的候选能力');b.value=a,g.value=h(a[0]),E.value=h(a[1]),k.value=h(a[2])}catch(e){console.error('Failed to initialize AbilitiesChoice:',e),g.value.ability_name='Error',g.value.ability_description=String(e),E.value.ability_name='Error',E.value.ability_description=String(e),k.value.ability_name='Error',k.value.ability_description=String(e)}}),(a,p)=>((0,e.openBlock)(),(0,e.createElementBlock)(e.Fragment,null,[p[3]||(p[3]=(0,e.createElementVNode)('div',{class:'hud-header'},[(0,e.createElementVNode)('h2',{class:'hud-block-title'},'[ 新的特殊能力 ]'),(0,e.createElementVNode)('div',{class:'hud-phase'},'选择一个祝福')],-1)),(0,e.createElementVNode)('div',{class:(0,e.normalizeClass)(['skill-upgrade-grid',{selecting:m.value}])},[(0,e.createElementVNode)('div',{class:'skill-card',id:'bast',onClick:p[0]||(p[0]=e=>N(0))},[(0,e.createElementVNode)('div',t,[(0,e.createElementVNode)('h3',i,(0,e.toDisplayString)(g.value.ability_name),1),(0,e.createElementVNode)('div',l,[(0,e.createElementVNode)('span',{class:'skill-quality',style:(0,e.normalizeStyle)({color:V(g.value.ability_quality)})},(0,e.toDisplayString)(g.value.ability_quality),5),(0,e.createElementVNode)('span',{class:'skill-nature',style:(0,e.normalizeStyle)({color:g.value.is_passive?'var(--detective-cyan)':'var(--erotic-pink)'})},(0,e.toDisplayString)(g.value.is_passive?'被动':'主动'),5)])]),(0,e.createElementVNode)('div',s,(0,e.toDisplayString)(g.value.ability_description),1)]),(0,e.createElementVNode)('div',{class:'skill-card',id:'hypnos',onClick:p[1]||(p[1]=e=>N(1))},[(0,e.createElementVNode)('div',r,[(0,e.createElementVNode)('h3',n,(0,e.toDisplayString)(E.value.ability_name),1),(0,e.createElementVNode)('div',o,[(0,e.createElementVNode)('span',{class:'skill-quality',style:(0,e.normalizeStyle)({color:V(E.value.ability_quality)})},(0,e.toDisplayString)(E.value.ability_quality),5),(0,e.createElementVNode)('span',{class:'skill-nature',style:(0,e.normalizeStyle)({color:E.value.is_passive?'var(--detective-cyan)':'var(--erotic-pink)'})},(0,e.toDisplayString)(E.value.is_passive?'被动':'主动'),5)])]),(0,e.createElementVNode)('div',c,(0,e.toDisplayString)(E.value.ability_description),1)]),(0,e.createElementVNode)('div',{class:'skill-card',id:'nodens',onClick:p[2]||(p[2]=e=>N(2))},[(0,e.createElementVNode)('div',d,[(0,e.createElementVNode)('h3',y,(0,e.toDisplayString)(k.value.ability_name),1),(0,e.createElementVNode)('div',u,[(0,e.createElementVNode)('span',{class:'skill-quality',style:(0,e.normalizeStyle)({color:V(k.value.ability_quality)})},(0,e.toDisplayString)(k.value.ability_quality),5),(0,e.createElementVNode)('span',{class:'skill-nature',style:(0,e.normalizeStyle)({color:k.value.is_passive?'var(--detective-cyan)':'var(--erotic-pink)'})},(0,e.toDisplayString)(k.value.is_passive?'被动':'主动'),5)])]),(0,e.createElementVNode)('div',v,(0,e.toDisplayString)(k.value.ability_description),1)])],2)],64))}});$(()=>{(0,e.createApp)(p).mount('#app')});
//# sourceMappingURL=index.js.map</script><style>@import url(https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;500;700&family=Orbitron:wght@400;700&display=swap);
/*! tailwindcss v4.1.17 | MIT License | https://tailwindcss.com */:root{--erotic-pink:#ff0077;--detective-cyan:#00ffff;--bg-dark:#10001a;--bg-panel:#2a0a3a;--border-color:rgba(255,0,119,0.3);--text-light:#f5f5f5;--text-dim:#b0a0c0;--aq-green:#44ff00;--aq-orange:#ff8000;--aq-gold:#ffcc00;--font-main:'Noto Sans SC',sans-serif}.hud-header{display:flex;flex-direction:column;align-items:center;gap:8px;text-align:center}.hud-block-title{color:var(--detective-cyan);font-family:var(--font-hud);margin:0}.hud-phase{color:var(--text-light);font-family:var(--font-hud);margin:0}.skill-upgrade-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-top:15px}.skill-card{background:linear-gradient(145deg,var(--bg-dark),var(--bg-panel));border:1px solid var(--border-color);border-radius:6px;padding:15px;display:flex;flex-direction:column;transition:all .3s ease;position:relative;overflow:hidden;cursor:pointer}.skill-upgrade-grid:not(.selecting) .skill-card:hover{transform:translateY(-5px);border-color:var(--detective-cyan);box-shadow:0 0 15px rgba(0,255,255,.3)}.skill-upgrade-grid.selecting .skill-card{pointer-events:none;opacity:.6}.skill-card-header{font-family:var(--font-hud);text-align:center;margin-bottom:15px}.skill-title{font-size:1.25rem;color:var(--detective-cyan);text-shadow:var(--cyan-glow);margin:0;padding-bottom:5px;border-bottom:1px dashed rgba(0,255,255,.4);text-transform:uppercase}.skill-meta{display:flex;justify-content:space-between;font-size:.8rem;margin-top:8px;color:var(--text-dim);text-transform:uppercase}.skill-quality,.skill-nature{padding:2px 6px;border-radius:3px;font-weight:700}.skill-card-body{font-family:var(--font-main);color:var(--text-light);font-size:.9rem;line-height:1.6;flex-grow:1;white-space:pre-wrap}@media (max-width:800px){.skill-upgrade-grid{grid-template-columns:1fr;gap:12px}.hud-header{flex-direction:column;align-items:flex-start;gap:8px}.skill-card{padding:12px}.skill-title{font-size:1.1rem}}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>