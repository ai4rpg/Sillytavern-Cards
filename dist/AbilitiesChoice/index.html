<head><script type="module">var e={441:(e,a)=>{a.A=(e,a)=>{const t=e.__vccOpts||e;for(const[e,i]of a)t[e]=i;return t}}},a={};const t=Vue;const i={class:'skill-card-header'},l={class:'skill-title'},s={class:'skill-meta'},r={class:'skill-quality'},n={class:'skill-nature'},o={class:'skill-card-body'},c={class:'skill-card-header'},d={class:'skill-title'},u={class:'skill-meta'},v={class:'skill-quality'},y={class:'skill-nature'},p={class:'skill-card-body'},m={class:'skill-card-header'},b={class:'skill-title'},g={class:'skill-meta'},E={class:'skill-quality'},k={class:'skill-nature'},V={class:'skill-card-body'},N=(0,t.defineComponent)({__name:'app',setup(e){const a=(0,t.ref)(!1),N=(0,t.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),h=(0,t.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),S=(0,t.ref)({ability_name:'Loading...',ability_quality:'',ability_description:'',is_passive:!1}),f=async e=>{a.value||(a.value=!0,await async function(e){try{await waitGlobalInitialized('Mvu');const a=Mvu.getMvuData({type:'message',message_id:'latest'});if(!a||!a.stat_data)throw new Error('未在聊天变量中找到 stat_data。');!1!==e.is_used&&(e.is_used=!1);const t=`_.assign('user.special_abilities[0]', ${e}); // choose a special abilities`,i=await Mvu.parseMessage(t,a);i&&await Mvu.replaceMvuData(i,{type:'message',message_id:'latest'}),toastr.success(`已选择能力: ${e.ability_name}`)}catch(e){console.error('Failed to select ability:',e),toastr.error(`选择能力失败: ${String(e)}`)}}(e))};return(0,t.onMounted)(async()=>{try{await waitGlobalInitialized('Mvu');const e=Mvu.getMvuData({type:'message',message_id:'latest'});if(!e||!e.stat_data)throw new Error('未在聊天变量中找到 stat_data。');const a=e?.stat_data?.latent_variables?.ability_update?.generated_abilities[0];if(!a||!Array.isArray(a)||3!==a.length)throw new Error('未能够正确获取 AI 生成的候选能力');N.value=a[0],h.value=a[1],S.value=a[2]}catch(e){console.error('Failed to initialize AbilitiesChoice:',e),N.value.ability_name='Error',N.value.ability_description=String(e),h.value.ability_name='Error',h.value.ability_description=String(e),S.value.ability_name='Error',S.value.ability_description=String(e)}}),(e,D)=>((0,t.openBlock)(),(0,t.createElementBlock)(t.Fragment,null,[D[3]||(D[3]=(0,t.createElementVNode)('div',{class:'hud-header'},[(0,t.createElementVNode)('h2',{class:'hud-block-title'},'[ 新的特殊能力 ]'),(0,t.createElementVNode)('div',{class:'hud-phase'},'选择一个祝福')],-1)),(0,t.createElementVNode)('div',{class:(0,t.normalizeClass)(['skill-upgrade-grid',{selecting:a.value}])},[(0,t.createElementVNode)('div',{class:'skill-card',id:'bast',onClick:D[0]||(D[0]=e=>f(N.value))},[(0,t.createElementVNode)('div',i,[(0,t.createElementVNode)('h3',l,(0,t.toDisplayString)(N.value.ability_name),1),(0,t.createElementVNode)('div',s,[(0,t.createElementVNode)('span',r,(0,t.toDisplayString)(N.value.ability_quality),1),(0,t.createElementVNode)('span',n,(0,t.toDisplayString)(N.value.is_passive?'被动':'主动'),1)])]),(0,t.createElementVNode)('div',o,(0,t.toDisplayString)(N.value.ability_description),1)]),(0,t.createElementVNode)('div',{class:'skill-card',id:'hypnos',onClick:D[1]||(D[1]=e=>f(h.value))},[(0,t.createElementVNode)('div',c,[(0,t.createElementVNode)('h3',d,(0,t.toDisplayString)(h.value.ability_name),1),(0,t.createElementVNode)('div',u,[(0,t.createElementVNode)('span',v,(0,t.toDisplayString)(h.value.ability_quality),1),(0,t.createElementVNode)('span',y,(0,t.toDisplayString)(h.value.is_passive?'被动':'主动'),1)])]),(0,t.createElementVNode)('div',p,(0,t.toDisplayString)(h.value.ability_description),1)]),(0,t.createElementVNode)('div',{class:'skill-card',id:'nodens',onClick:D[2]||(D[2]=e=>f(S.value))},[(0,t.createElementVNode)('div',m,[(0,t.createElementVNode)('h3',b,(0,t.toDisplayString)(S.value.ability_name),1),(0,t.createElementVNode)('div',g,[(0,t.createElementVNode)('span',E,(0,t.toDisplayString)(S.value.ability_quality),1),(0,t.createElementVNode)('span',k,(0,t.toDisplayString)(S.value.is_passive?'被动':'主动'),1)])]),(0,t.createElementVNode)('div',V,(0,t.toDisplayString)(S.value.ability_description),1)])],2)],64))}});var h=function t(i){var l=a[i];if(void 0!==l)return l.exports;var s=a[i]={exports:{}};return e[i](s,s.exports,t),s.exports}(441);const S=(0,h.A)(N,[['__scopeId','data-v-df14af94']]);$(()=>{(0,t.createApp)(S).mount('#app')});
//# sourceMappingURL=index.js.map</script><style>.hud-header[data-v-df14af94]{display:flex;justify-content:space-between;align-items:center}.hud-block-title[data-v-df14af94]{color:var(--detective-cyan);font-family:var(--font-hud);margin:0}.skill-upgrade-grid[data-v-df14af94]{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin-top:15px}.skill-card[data-v-df14af94]{background:rgba(0,0,0,.3);border:1px solid var(--border-color);border-radius:6px;padding:15px;display:flex;flex-direction:column;transition:all .3s ease;position:relative;overflow:hidden;cursor:pointer}.skill-upgrade-grid:not(.selecting) .skill-card[data-v-df14af94]:hover{transform:translateY(-5px);border-color:var(--detective-cyan);box-shadow:0 0 15px rgba(0,255,255,.3)}.skill-upgrade-grid.selecting .skill-card[data-v-df14af94]{pointer-events:none;opacity:.6}.skill-card-header[data-v-df14af94]{font-family:var(--font-hud);text-align:center;margin-bottom:15px}.skill-title[data-v-df14af94]{font-size:1.25rem;color:var(--detective-cyan);text-shadow:var(--cyan-glow);margin:0;padding-bottom:5px;border-bottom:1px dashed rgba(0,255,255,.4);text-transform:uppercase}.skill-meta[data-v-df14af94]{display:flex;justify-content:space-between;font-size:.8rem;margin-top:8px;color:var(--text-dim);text-transform:uppercase}.skill-quality[data-v-df14af94],.skill-nature[data-v-df14af94]{padding:2px 6px;border-radius:3px;font-weight:700}.skill-card-body[data-v-df14af94]{font-family:var(--font-main);color:var(--text-light);font-size:.9rem;line-height:1.6;flex-grow:1;white-space:pre-wrap}@media (max-width:900px){.skill-upgrade-grid[data-v-df14af94]{grid-template-columns:1fr;gap:12px}.hud-header[data-v-df14af94]{flex-direction:column;align-items:flex-start;gap:8px}.skill-card[data-v-df14af94]{padding:12px}.skill-title[data-v-df14af94]{font-size:1.1rem}}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body>